<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>0107 Happy Birthday</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            /* èƒŒæ™¯ï¼šæ¸…æ–°çš„æ™¨æ›¦æ¼¸å±¤ */
            background: linear-gradient(120deg, #a1c4fd 0%, #c2e9fb 100%);
            font-family: "Microsoft JhengHei", "Noto Sans TC", sans-serif;
            overflow: hidden;
            /* æ¸¸æ¨™æ—é‚Šæœƒæœ‰ä¸€æ”¯ç­†çš„æ„Ÿè¦º (ç¤ºæ„) */
            cursor: crosshair;
        }

        /* äº’å‹•ç•«å¸ƒ */
        #canvas-trail {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

        #giftButton {
            padding: 22px 50px;
            font-size: 24px;
            font-weight: bold;
            background: #fff;
            color: #555;
            border: 2px solid #a1c4fd;
            border-radius: 60px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(161, 196, 253, 0.4);
            z-index: 10001;
            transition: 0.3s;
        }
        #giftButton:hover {
            background: #a1c4fd;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(161, 196, 253, 0.6);
        }
        
        .message {
            position: absolute;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px; /* æ”¹å¾—æ¯”è¼ƒåƒä¾¿åˆ©è²¼ */
            box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
            font-size: 16px;
            color: #444;
            pointer-events: auto; 
            cursor: pointer;
            user-select: none;
            border: 1px solid #eee;
            transition: transform 0.2s;
        }

        .message:hover {
            transform: scale(1.1) !important;
            background: #fff;
            border-color: #a1c4fd;
            color: #2b5876;
            z-index: 10002 !important;
        }

        .message.clicked {
            animation: burst 0.4s ease-out forwards;
        }

        @keyframes burst {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.5; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        
        #finalMessage {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.5);
            text-align: center;
            background: rgba(255, 255, 255, 0.98);
            padding: 40px;
            width: 85%;
            max-width: 420px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            z-index: 20000;
            display: none;
            opacity: 0;
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            border: 3px solid #c2e9fb;
        }

        #finalMessage.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .math-highlight {
            color: #e66465;
            font-weight: bold;
            font-family: "Times New Roman", serif;
            font-size: 1.2em;
            background: #fff0f0;
            padding: 2px 5px;
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <canvas id="canvas-trail"></canvas>
    <button id="giftButton">ğŸ 0107 é»é€™è£¡</button>

    <div id="finalMessage">
        <h2 style="color: #444; margin-bottom: 20px;">Happy Birthday</h2>
        
        <p style="color: #666; line-height: 1.8; font-size: 16px;">
            æœ‰å¦³åœ¨ï¼Œå¿«æ¨‚å°±åƒ <span class="math-highlight">(a+b)Â²</span><br>
            æ¯”æˆ‘å€‘å„è‡ªç›¸åŠ ï¼Œ<br>
            é‚„å¤šå‡ºäº† <span class="math-highlight">2ab</span> çš„é©šå–œã€‚
        </p>
        
        <hr style="border: 0; border-top: 1px dashed #ccc; margin: 25px 0;">
        
        <p style="font-size: 15px; color: #555;">
            æœªä¾†çš„åœ‹ä¸­ç”Ÿæ´»ï¼Œ<br>
            ä¸ç®¡è€ƒå·å¤šé›£ï¼Œè¨˜å¾—å›é ­ï¼Œ<br>
            æˆ‘éƒ½åœ¨ã€‚
        </p>
        <p style="margin-top: 25px; font-size: 13px; color: #999;">â€”â€” ç¥ 1/7 ç”Ÿæ—¥å¿«æ¨‚</p>
    </div>

    <script>
        const CONFIG = {
            totalMessages: 25,     
            speedMs: 250,          
            floatDuration: 12,     
            colors: ['#a1c4fd', '#c2e9fb', '#ff9a9e', '#fbc2eb'] 
        };

        // åœ‹äºŒæ•¸å­¸æ¢— + æš–å¿ƒèªéŒ„
        const messages = [
            "0107 ç”Ÿæ—¥å¿«æ¨‚ï¼", 
            "å¿ƒæƒ…è¦åƒ |x| (çµ•å°å€¼) ä¸€æ¨£æ°¸é æ­£å‘", 
            "å¦³çš„åŠªåŠ›ï¼Œæ™‚é–“æœƒå¹«å¦³é–‹æ ¹è™Ÿ", 
            "æˆ‘å€‘æ˜¯æœ€ä½³ 3-4-5 ç•¢æ°æ•¸çµ„", 
            "åˆ¥æ“”å¿ƒï¼Œé›£é¡Œç¸½æœ‰è§£", 
            "å¦³æ˜¯æœ€æ£’çš„", 
            "ä»Šå¤©ä¸ç”¨ç®—æ•¸å­¸ï¼Œåªè¦ç®—å¿«æ¨‚", 
            "ç…©æƒ±å…¨éƒ¨æ­¸é›¶", 
            "ä½ æ˜¯ç¨ä¸€ç„¡äºŒçš„è³ªæ•¸", 
            "é›–ç„¶ä¸æ˜¯100åˆ†ï¼Œä½†æ˜¯å¾ˆå®Œç¾", 
            "ç´¯äº†å°±ä¼‘æ¯ä¸€ä¸‹", 
            "é€™ä¸€å¹´è¾›è‹¦äº†", 
            "æ˜å¤©çš„å¦³æœƒæ›´è€€çœ¼", 
            "é€™é¡Œæˆ‘æœƒï¼Œæˆ‘æ•™å¦³", 
            "æ°¸é æ”¯æŒå¦³", 
            "ä¸å‡†ä¸é–‹å¿ƒ",
            "æƒ³è¦ä»€éº¼ç”Ÿæ—¥é¡˜æœ›ï¼Ÿ", 
            "ä¿æŒå–„è‰¯ï¼Œä¿æŒå¯æ„›", 
            "Happy Birthday!", 
            "è¨˜å¾—å¤šå–æ°´", 
            "æœ‰å¿ƒäº‹å¯ä»¥è·Ÿæˆ‘èªª",
            "æˆ‘å€‘æ˜¯æœ€ä½³æ‹æª”", 
            "åŠ æ²¹ï¼ä½ å¯ä»¥çš„",
            "é€™æ®µè·¯æœ‰å¦³çœŸå¥½"
        ];

        const btn = document.getElementById('giftButton');
        const finalMsg = document.getElementById('finalMessage');
        let zIndexCounter = 1000;
        let isStarted = false;

        // 1. ç•«å¸ƒè»Œè·¡ (æ”¹ç‚ºåœ‹ä¸­æ•¸å­¸ç¬¦è™Ÿ)
        const canvas = document.getElementById('canvas-trail');
        const ctx = canvas.getContext('2d');
        let width, height;
        let particles = [];

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // ç¬¦è™Ÿæ”¹ç‚ºï¼šæ ¹è™Ÿã€åŠ æ¸›ä¹˜é™¤ã€ä¸‰è§’å½¢ã€Xã€Y
        const symbols = ['âˆš', '+', '-', 'Ã—', 'Ã·', 'â–³', 'x', 'y', 'Ï€'];

        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 12 + 8;
                this.text = symbols[Math.floor(Math.random() * symbols.length)];
                this.color = CONFIG.colors[Math.floor(Math.random() * CONFIG.colors.length)];
                this.speedX = Math.random() * 2 - 1;
                this.speedY = Math.random() * 2 - 1;
                this.life = 1; 
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.life -= 0.02; 
                this.size *= 0.95; 
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.life;
                ctx.font = `bold ${this.size}px Arial`;
                ctx.fillText(this.text, this.x, this.y);
            }
        }

        function handleMove(e) {
            const x = e.touches ? e.touches[0].clientX : e.clientX;
            const y = e.touches ? e.touches[0].clientY : e.clientY;
            particles.push(new Particle(x, y));
        }

        window.addEventListener('mousemove', handleMove);
        window.addEventListener('touchmove', handleMove);

        function animateTrail() {
            ctx.clearRect(0, 0, width, height);
            for (let i = 0; i < particles.length; i++) {
                particles[i].update();
                particles[i].draw();
                if (particles[i].life <= 0) {
                    particles.splice(i, 1);
                    i--;
                }
            }
            requestAnimationFrame(animateTrail);
        }
        animateTrail();

        // 2. æŒ‰éˆ•é‚è¼¯
        btn.addEventListener('click', () => {
            if(isStarted) return;
            isStarted = true;
            btn.style.transform = "scale(0.8)";
            btn.style.opacity = "0";
            setTimeout(() => btn.style.display = 'none', 300);

            let count = 0;
            const interval = setInterval(() => {
                if (count >= CONFIG.totalMessages) {
                    clearInterval(interval);
                    setTimeout(showFinalCard, 1500);
                    return;
                }
                createInteractiveMessage();
                count++;
            }, CONFIG.speedMs);
        });

        // 3. è¨Šæ¯æ³¡æ³¡
        function createInteractiveMessage() {
            const div = document.createElement('div');
            div.className = 'message';
            div.style.zIndex = zIndexCounter++;
            div.innerHTML = messages[Math.floor(Math.random() * messages.length)];
            
            const x = Math.random() * (window.innerWidth - 160) + 20;
            const y = Math.random() * (window.innerHeight - 100) + 50;
            const rot = (Math.random() - 0.5) * 15;

            div.style.left = x + 'px';
            div.style.top = y + 'px';
            div.style.transform = `rotate(${rot}deg) scale(0)`;
            
            document.body.appendChild(div);

            requestAnimationFrame(() => {
                div.style.transform = `rotate(${rot}deg) scale(1)`;
            });

            // é»æ“Šäº‹ä»¶
            div.addEventListener('click', (e) => {
                e.stopPropagation(); 
                createBurst(e.clientX, e.clientY); 
                div.classList.add('clicked'); 
                setTimeout(() => div.remove(), 400); 
            });
            
            // è‡ªå‹•æ¶ˆå¤±
            setTimeout(() => {
                if(div.parentNode) {
                    div.style.opacity = 0;
                    setTimeout(() => div.remove(), 500);
                }
            }, CONFIG.floatDuration * 1000);
        }

        function createBurst(x, y) {
            for(let i=0; i<6; i++) {
                particles.push(new Particle(x, y));
            }
        }

        function showFinalCard() {
            finalMsg.style.display = 'block';
            createConfetti();
            setTimeout(() => finalMsg.classList.add('show'), 50);
        }

        function createConfetti() {
            for (let i = 0; i < 60; i++) {
                const conf = document.createElement('div');
                conf.style.position = 'fixed';
                conf.style.width = Math.random() * 8 + 4 + 'px';
                conf.style.height = Math.random() * 8 + 4 + 'px';
                conf.style.backgroundColor = CONFIG.colors[Math.floor(Math.random() * CONFIG.colors.length)];
                conf.style.left = Math.random() * 100 + 'vw';
                conf.style.top = -10 + 'px';
                conf.style.zIndex = 20001;
                conf.style.borderRadius = '50%';
                conf.style.transition = `top ${Math.random() * 2 + 2}s ease-in, transform 2s ease`;
                document.body.appendChild(conf);

                setTimeout(() => {
                    conf.style.top = '105vh';
                    conf.style.transform = `rotate(${Math.random() * 360}deg)`;
                }, 100);
            }
        }
    </script>
</body>
</html>
